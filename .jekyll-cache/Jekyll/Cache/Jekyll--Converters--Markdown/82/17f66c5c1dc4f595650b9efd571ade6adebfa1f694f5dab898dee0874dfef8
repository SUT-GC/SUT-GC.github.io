I"…ß<ul class="toc" id="markdown-toc">
  <li><a href="#heading-ç”¨forkjoinquasarå¯¹ioå¯†é›†å‹æœåŠ¡è¿›è¡Œä¼˜åŒ–" id="markdown-toc-heading-ç”¨forkjoinquasarå¯¹ioå¯†é›†å‹æœåŠ¡è¿›è¡Œä¼˜åŒ–">ç”¨ForkJoin&amp;Quasarå¯¹IOå¯†é›†å‹æœåŠ¡è¿›è¡Œä¼˜åŒ–</a>    <ul>
      <li><a href="#heading-èƒŒæ™¯ä»‹ç»" id="markdown-toc-heading-èƒŒæ™¯ä»‹ç»">èƒŒæ™¯ä»‹ç»</a></li>
      <li><a href="#heading-ä¼˜åŒ–" id="markdown-toc-heading-ä¼˜åŒ–">ä¼˜åŒ–</a>        <ul>
          <li><a href="#heading-åˆå¹¶å¤šæ¬¡è¯·æ±‚" id="markdown-toc-heading-åˆå¹¶å¤šæ¬¡è¯·æ±‚">åˆå¹¶å¤šæ¬¡è¯·æ±‚</a></li>
          <li><a href="#heading-è¯·æ±‚å¼‚æ­¥ä»£ç†" id="markdown-toc-heading-è¯·æ±‚å¼‚æ­¥ä»£ç†">è¯·æ±‚å¼‚æ­¥ä»£ç†</a></li>
          <li><a href="#heading-è¯·æ±‚å¹¶å‘å¤„ç†" id="markdown-toc-heading-è¯·æ±‚å¹¶å‘å¤„ç†">è¯·æ±‚å¹¶å‘å¤„ç†</a></li>
        </ul>
      </li>
      <li><a href="#heading-æ€§èƒ½æ¯”è¾ƒ" id="markdown-toc-heading-æ€§èƒ½æ¯”è¾ƒ">æ€§èƒ½æ¯”è¾ƒ</a>        <ul>
          <li><a href="#heading-mainjava" id="markdown-toc-heading-mainjava">Main.java</a></li>
          <li><a href="#heading-myservicejava" id="markdown-toc-heading-myservicejava">MyService.java</a></li>
          <li><a href="#heading-otherservice" id="markdown-toc-heading-otherservice">OtherService</a></li>
          <li><a href="#heading-æµ‹è¯•æ•°æ®å’Œç»“æœ" id="markdown-toc-heading-æµ‹è¯•æ•°æ®å’Œç»“æœ">æµ‹è¯•æ•°æ®å’Œç»“æœ</a></li>
          <li><a href="#heading-jstack" id="markdown-toc-heading-jstack">jstack</a></li>
        </ul>
      </li>
      <li><a href="#heading-è¿˜å¯ä»¥æ›´å¥½" id="markdown-toc-heading-è¿˜å¯ä»¥æ›´å¥½">è¿˜å¯ä»¥æ›´å¥½</a></li>
      <li><a href="#heading-å‚è€ƒèµ„æ–™" id="markdown-toc-heading-å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™</a></li>
      <li><a href="#heading-æ„Ÿè°¢" id="markdown-toc-heading-æ„Ÿè°¢">æ„Ÿè°¢</a></li>
      <li><a href="#heading-github" id="markdown-toc-heading-github">GitHub</a></li>
    </ul>
  </li>
</ul>

<h1 id="heading-ç”¨forkjoinquasarå¯¹ioå¯†é›†å‹æœåŠ¡è¿›è¡Œä¼˜åŒ–">ç”¨ForkJoin&amp;Quasarå¯¹IOå¯†é›†å‹æœåŠ¡è¿›è¡Œä¼˜åŒ–</h1>

<h2 id="heading-èƒŒæ™¯ä»‹ç»">èƒŒæ™¯ä»‹ç»</h2>

<p>åšä¸šåŠ¡ç³»ç»Ÿå¼€å‘é¢å¯¹çš„æœåŠ¡å¤§éƒ½æ˜¯IOå¯†é›†å‹æœåŠ¡ï¼Œè¿™é‡ŒæŒ‡çš„IOå¯å¤§è‡´åˆ†ä¸ºå¦‚ä¸‹å‡ ç§ï¼š</p>

<ul>
  <li>æ•°æ®åº“ IO</li>
  <li>ç¼“å­˜ IO</li>
  <li>ç½‘ç»œ IO</li>
</ul>

<p>è¿™é‡Œæš‚æ—¶ä¸è°ˆ ç¼“å­˜IOï¼Œå› ä¸ºç¼“å­˜IOéƒ½å‘ç”Ÿåœ¨å†…å­˜ä¸Šï¼Œé€Ÿåº¦å¾ˆå¿«ï¼Œå¯ä»¥å¿½ç•¥è¿™éƒ¨åˆ†IO</p>

<p>ä¹Ÿæœ‰äººå¯èƒ½ä¼šç–‘æƒ‘ä¸ºä»€ä¹ˆä¼šå­˜åœ¨ç½‘è·¯IOï¼Ÿ</p>

<p>ç°åœ¨ç¨å¾®å¤§ä¸€ç‚¹çš„å…¬å¸éƒ½åœ¨åšå¾®æœåŠ¡ï¼Œæ ¹æ®ä¸šåŠ¡é¢†åŸŸè¿›è¡ŒæœåŠ¡åˆ’åˆ†ï¼Œå°†æœåŠ¡ä¸æœåŠ¡å°½å¯èƒ½çš„è¿›è¡Œè§£è€¦ï¼Œæ–¹ä¾¿ç®¡ç†ï¼Œæ–¹ä¾¿ç»´æŠ¤ï¼Œå°†å¼€å‘æ•ˆç‡æœ€å¤§åŒ–ã€‚</p>

<p>ä½†ä¹Ÿå› æ­¤ï¼Œå¾ˆå¤šå•æœåŠ¡ä¸å­˜åœ¨çš„é—®é¢˜ä¹Ÿä¼šéšå³è€Œæ¥ï¼Œæ¯”å¦‚å¢åŠ ç½‘ç»œIOï¼šæ‰€æœ‰ç‰¹å®šä¸šåŠ¡é¢†åŸŸå†…çš„æœåŠ¡å°†å¯æä¾›æœåŠ¡æ³¨å†Œåˆ°æ²»ç†ä¸­å¿ƒï¼Œç”±æ²»ç†ä¸­å¿ƒè¿›è¡ŒæœåŠ¡è°ƒåº¦åˆ†å‘ï¼ŒæœåŠ¡ä¸æœåŠ¡ä¹‹é—´ä¸å†ç®€å•çš„é€šè¿‡å†…å­˜æ¥å£è¿›è¡Œäº¤æµï¼Œè€Œæ˜¯å°†è¯·æ±‚ä¿¡æ¯é€šè¿‡ç½‘ç»œæ‰“åˆ°æ‰€ä¾èµ–çš„æœåŠ¡ä¸Šï¼Œç½‘ç»œå»¶è¿Ÿå¯æ˜¯ä¸å¯é¿å…çš„ã€‚å¦‚æœç½‘ç»œè¾ƒå¥½çš„æƒ…å†µä¸‹å¤§æ¦‚å‡ æ¯«ç§’åˆ°å‡ åæ¯«ç§’ï¼Œå¦‚æœç½‘ç»œä¸å¥½å°±å¯èƒ½å‡ºç°å‡ ç™¾æ¯«ç§’ç”šè‡³ç§’çº§ã€‚</p>

<p><img src="http://7xoguv.com1.z0.glb.clouddn.com/fj-q-1.png" alt="å¾®æœåŠ¡è°ƒç”¨" /></p>

<p>è¿™é‡Œæˆ‘ä»¬ç»™å‡ºä¸ªæ¦‚å¿µå›¾ï¼Œå½“è¯·æ±‚<code class="language-plaintext highlighter-rouge">A</code>æœåŠ¡æ—¶ï¼Œ<code class="language-plaintext highlighter-rouge">A</code>æœåŠ¡è¦è°ƒç”¨<code class="language-plaintext highlighter-rouge">B</code>ã€<code class="language-plaintext highlighter-rouge">C</code>ã€<code class="language-plaintext highlighter-rouge">D</code>ä¸‰ä¸ªæœåŠ¡ï¼Œå¹¶ä¸”è¦æŸ¥è¯¢ä¸€æ¬¡æ•°æ®åº“ <code class="language-plaintext highlighter-rouge">E</code>ï¼Œ å¹¶ä¸”å°†å››ä¸ªç»“æœç»„è£…æˆä¸€ä¸ªå®ä½“è¿”å›å‡ºå»ã€‚ å¦‚æœ<code class="language-plaintext highlighter-rouge">A</code>å†…éƒ¨ä»£ç æ˜¯é¡ºåºå¤„ç†çš„ï¼Œé‚£ä¹ˆè¿™æ¬¡è¯·æ±‚çš„æ•´ä½“å“åº”æ—¶é—´åˆ™ä¸º <code class="language-plaintext highlighter-rouge">B</code>çš„å“åº”æ—¶é—´+<code class="language-plaintext highlighter-rouge">C</code>çš„å“åº”æ—¶é—´+<code class="language-plaintext highlighter-rouge">D</code>çš„å“åº”æ—¶é—´+<code class="language-plaintext highlighter-rouge">E</code>çš„å“åº”æ—¶é—´+<code class="language-plaintext highlighter-rouge">A</code>å†…éƒ¨é€»è¾‘å¤„ç†æ—¶é—´ã€‚ (<code class="language-plaintext highlighter-rouge">B</code>çš„å“åº”æ—¶é—´åŒ…æ‹¬<code class="language-plaintext highlighter-rouge">A</code>è¯·æ±‚<code class="language-plaintext highlighter-rouge">B</code>çš„ç½‘ç»œå»¶è¿Ÿæ—¶é—´)ã€‚ä¹Ÿå°±æ˜¯è¯´<code class="language-plaintext highlighter-rouge">A</code>çš„å“åº”æ—¶é—´ä¸å•å•ä¸è‡ªå·±çš„ä»£ç é€»è¾‘æœ‰å…³ï¼Œè¿˜è¦ä¸å…¶ä»–æœåŠ¡çš„ä»£ç é€»è¾‘æœ‰å…³ï¼Œè¿˜è¦ä¸ç½‘ç»œå»¶è¿Ÿæœ‰å…³ï¼Œ å¦‚æœå…¶ä¸­æœ‰ä¸€ä¸ªç¯èŠ‚å»¶è¿Ÿå¢åŠ éƒ½ä¼šå¢åŠ æ•´ä¸ªè¯·æ±‚çš„å“åº”æ—¶é—´ã€‚</p>

<p>ä¸€ä¸ªè¯·æ±‚å¤§æ¦‚æ˜¯è¿™æ ·çš„(OtherServiceåŒ…æ‹¬DBè¯»å†™)ï¼š</p>

<p><img src="http://7xoguv.com1.z0.glb.clouddn.com/fj-q-2.png" alt="é¡ºåºæ—¶åºå›¾1" /></p>

<h2 id="heading-ä¼˜åŒ–">ä¼˜åŒ–</h2>

<p>æœåŠ¡å±‚é¢çš„ä¼˜åŒ–çš„æ–¹å‘å¤§è‡´æœ‰ä¸‹é¢è¿™å‡ ç§ï¼Œä¼˜åŒ–çš„åœ°æ–¹éƒ½æ˜¯åœ¨ <code class="language-plaintext highlighter-rouge">MyService</code> -&gt; <code class="language-plaintext highlighter-rouge">OtherService</code> è¿™ä¸€æ­¥ä¸Šï¼š</p>

<ul>
  <li>åˆå¹¶å¤šæ¬¡è¯·æ±‚</li>
  <li>è¯·æ±‚å¼‚æ­¥ä»£ç†</li>
  <li>è¯·æ±‚å¹¶å‘å¤„ç†</li>
</ul>

<h3 id="heading-åˆå¹¶å¤šæ¬¡è¯·æ±‚">åˆå¹¶å¤šæ¬¡è¯·æ±‚</h3>

<p>å°†å¤šæ¬¡è¯·æ±‚åˆå¹¶æˆä¸€æ¬¡ï¼Œå°†å•é‡è°ƒç”¨æ”¹æˆæ‰¹é‡è°ƒç”¨ã€‚ è¿™ç§æ˜¯å˜åŠ¨æœ€å°ï¼Œé£é™©æœ€å°çš„åŠæ³•ï¼Œå´ä¹Ÿæ˜¯æ¯”è¾ƒéš¾æ¨åŠ¨çš„åŠæ³•ã€‚</p>

<p>å¦‚æœæˆ‘ä»¬è°ƒç”¨çš„æœåŠ¡ä»…ä»…æä¾›äº†å•é‡è°ƒç”¨æ¥å£ï¼Œå°±éœ€è¦è¢«è°ƒç”¨æ–¹è¿›è¡Œæ‰¹é‡æ¥å£æä¾›ã€‚éœ€è¦å„æœåŠ¡ä¹‹é—´åä½œæ”¯æŒï¼ˆä¹Ÿè®¸æˆ‘ä»¬æå‡ºçš„æ˜¯ä¸€ä¸ªæ¯”è¾ƒç‰¹åˆ«çš„éœ€æ±‚ï¼Œä¹Ÿè®¸æä¾›æ¥å£çš„æ€§ä»·æ¯”ä¸é«˜ï¼Œå¾ˆå®¹æ˜“é­å—åˆ°ä¾èµ–æ–¹çš„æ‹’ç»ï½ï¼‰ï¼Œè¿™ç§æ–¹æ³•æ— å…³æŠ€æœ¯ï¼Œå±äºäº¤æµè§£å†³é—®é¢˜ã€‚</p>

<h3 id="heading-è¯·æ±‚å¼‚æ­¥ä»£ç†">è¯·æ±‚å¼‚æ­¥ä»£ç†</h3>

<p>è¿™ç§æ–¹æ³•éœ€è¦åœ¨ <code class="language-plaintext highlighter-rouge">MyService</code> å’Œ <code class="language-plaintext highlighter-rouge">OtherService</code> ä¹‹é—´å†ä»‹å…¥ä¸€å±‚ <code class="language-plaintext highlighter-rouge">Agent</code> ï¼Œå¤§è‡´ç»“æ„å¦‚ä¸‹:</p>

<p><img src="http://7xoguv.com1.z0.glb.clouddn.com/fj-q-4.png" alt="è¯·æ±‚å¼‚æ­¥ä»£ç†1" /></p>

<p>å½“<code class="language-plaintext highlighter-rouge">A</code>è¦è°ƒç”¨<code class="language-plaintext highlighter-rouge">OtherService</code>çš„æ—¶å€™ï¼Œä¼šè®©<code class="language-plaintext highlighter-rouge">Agent</code>å¼‚æ­¥å»è¯·æ±‚<code class="language-plaintext highlighter-rouge">OtherService</code>ï¼Œå½“<code class="language-plaintext highlighter-rouge">Agent</code>å¯¹<code class="language-plaintext highlighter-rouge">OtherService</code>è¯·æ±‚æœ‰ç»“æœçš„æ—¶å€™å°†ç»“æœå¼‚æ­¥è¿”å›ç»™<code class="language-plaintext highlighter-rouge">A</code>ï¼Œè¿™æ ·æ•´ä½“çš„å“åº”æ—¶é—´ä¹Ÿå°±å˜æˆ å†…éƒ¨é€»è¾‘æ—¶é—´ + max(<code class="language-plaintext highlighter-rouge">OtherService Response Times</code>)</p>

<p>ä½†è¿™ç§æ¶æ„çš„ä¿®æ”¹å¸¦æ¥ç³»ç»Ÿç¨³å®šæ€§çš„é™ä½ï¼ŒæœåŠ¡Aå’ŒæœåŠ¡Bã€Cã€Dä¹‹é—´çš„é€šè®¯å¢åŠ äº†å¤æ‚æ€§ã€‚åŒæ—¶ï¼Œå› ä¸ºæ˜¯å¼‚æ­¥æ–¹å¼ï¼ŒæœåŠ¡Açš„ä¸šåŠ¡ä¹Ÿè¦å®ç°å¼‚æ­¥æ–¹å¼ï¼Œå¦åˆ™è¿˜æ˜¯ä¸€ä¸ªé˜»å¡çš„æ¶æ„ã€‚ è€Œä¸”å¯¹<code class="language-plaintext highlighter-rouge">Agent</code>çš„å®ç°ä¹Ÿæœ‰ç€æ¯”è¾ƒé«˜çš„å¹¶å‘è¦æ±‚ã€‚</p>

<h3 id="heading-è¯·æ±‚å¹¶å‘å¤„ç†">è¯·æ±‚å¹¶å‘å¤„ç†</h3>

<p>è¯·æ±‚å¹¶å‘å¤„ç†åº”è¯¥æ˜¯ç›¸å¯¹æ¥è¯´æ¯”è¾ƒç®€å•ä¸”å®ç”¨çš„å®ç°åŠæ³•ï¼Œ è€Œä¸”æœ‰ç°æˆçš„æ¡†æ¶æ”¯æŒå¹¶å‘å¤„ç†ï¼Œæ¯”å¦‚Executor, ForkJoin, Quasar â€¦</p>

<h4 id="heading-executor">Executor</h4>

<p>æä¾›ç°æœ‰çš„çº¿ç¨‹æ± ï¼Œä»£ç ç®€å•</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">ExecutorService</span> <span class="n">executorPool</span> <span class="o">=</span> <span class="nc">Executors</span><span class="o">.</span><span class="na">newFixedThreadPool</span><span class="o">(</span><span class="mi">10</span><span class="o">);</span>
<span class="nc">Future</span><span class="o">&lt;</span><span class="nc">Object</span><span class="o">&gt;</span> <span class="n">future</span> <span class="o">=</span> <span class="n">executorService</span><span class="o">.</span><span class="na">submit</span><span class="o">(</span><span class="k">new</span> <span class="nc">Callable</span><span class="o">&lt;</span><span class="nc">Object</span><span class="o">&gt;()</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nc">Object</span> <span class="nf">call</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="nc">OtherService</span> <span class="n">otherService</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">OtherService</span><span class="o">();</span>
        <span class="k">return</span> <span class="n">otherService</span><span class="o">.</span><span class="na">dispose</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">})</span>
<span class="c1">// future.get() æ‹¿åˆ°è¿”å›å€¼ OR å¼‚å¸¸</span>
</code></pre></div></div>

<h4 id="heading-forkjoin">ForkJoin</h4>

<p>ä¸ Executor ç±»ä¼¼ï¼Œ ForkJoin æä¾›çš„çº¿ç¨‹æ± ï¼ˆæ„Ÿè§‰ä¸åº”è¯¥å«åšçº¿ç¨‹æ± äº†ï¼‰æœ€å¤§ä¸º cpuæ ¸å¿ƒæ•°ï¼Œè™½ç„¶Excutorçº¿ç¨‹æ± å¤§å°å¯ä»¥è‡ªå®šä¹‰ï¼Œä½†å…¶å®çœŸæ­£èƒ½å¹¶å‘è¿è¡Œçš„ä¸è¿‡CPUçš„æ ¸å¿ƒæ•°é‚£ä¹ˆå¤šï¼Œcpuæ ¸å¿ƒæ•° çš„çº¿ç¨‹æ± æ„Ÿè§‰è¶³å¤Ÿäº†ã€‚</p>

<p>ForkJoin è¿˜å¢åŠ äº†work-stealing(å·¥ä½œçªƒå–ç®—æ³•)ï¼Œä¸ºäº†æé«˜å¯¹ä»»åŠ¡çš„å¤„ç†æ•ˆç‡ã€‚</p>

<p><img src="http://7xoguv.com1.z0.glb.clouddn.com/fj-q-5.png" alt="å·¥ä½œçªƒå–1ï¼Œå›¾ç‰‡æ¥æºç½‘ç»œï¼Œä¾µåˆ " /></p>

<p>ä¸¤ä¸ªçº¿ç¨‹é˜Ÿåˆ—åŒæ—¶å¤„ç†ä»»åŠ¡ï¼Œå¦‚æœçº¿ç¨‹é˜Ÿåˆ—1çš„ä»»åŠ¡å·²ç»å¤„ç†å®Œæ¯•ä¸”æ²¡æœ‰æ–°ä»»åŠ¡è¿›æ¥æ—¶ï¼Œå¦‚æœå…¶ä»–çº¿ç¨‹é˜Ÿåˆ—æœ‰ä»»åŠ¡æ²¡å¤„ç†å®Œï¼Œçº¿ç¨‹1å›å»å…¶ä»–é˜Ÿåˆ—é‡Œ"å·å–"ä»»åŠ¡ç”¨æ¥åŠ å¿«å¤„ç†ã€‚</p>

<blockquote>
  <p>è¿™é‡Œä¸€å®šæ˜¯ä»é˜Ÿåˆ—å°¾å·ä»»åŠ¡</p>
</blockquote>

<p>å…¶å®ä»£ç å†™èµ·æ¥ä¹Ÿæ˜¯è›®ç®€å•çš„ï¼Œ ä¸Executorç±»ä¼¼</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">ForkJoinPool</span> <span class="n">forkJoinPool</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ForkJoinPool</span><span class="o">();</span>
<span class="nc">Future</span><span class="o">&lt;</span><span class="nc">Object</span><span class="o">&gt;</span> <span class="n">future</span> <span class="o">=</span> <span class="n">forkJoinPool</span><span class="o">.</span><span class="na">submit</span><span class="o">(</span><span class="k">new</span> <span class="nc">Callable</span><span class="o">&lt;</span><span class="nc">Object</span><span class="o">&gt;()</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nc">Object</span> <span class="nf">call</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="nc">OtherService</span> <span class="n">otherService</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">OtherService</span><span class="o">();</span>
        <span class="k">return</span> <span class="n">otherService</span><span class="o">.</span><span class="na">dispose</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">})</span>
</code></pre></div></div>

<p>ç®—æ³•å’Œçº¿ç¨‹æ± çš„é…ç½®éƒ½æ˜¯å°è£…å¥½çš„ï¼Œæ²¡ä»€ä¹ˆå¯ä»¥è¯´çš„ã€‚</p>

<h4 id="heading-quasar">Quasar</h4>

<p>è¿™ä¸ªæ˜¯Javaçš„ä¸€ä¸ªå®ç°åç¨‹çš„æ¡†æ¶ï¼Œå¤§è‡´çš„åŸç†å¦‚ä¸‹ï¼š</p>

<ul>
  <li>Quasar ä¸­å­˜åœ¨é»˜è®¤çš„workçº¿ç¨‹</li>
  <li>workçº¿ç¨‹è½®è¯¢æ‰§è¡Œåç¨‹ä»»åŠ¡</li>
  <li>å½“è¯¥ä»»åŠ¡é‡åˆ°é˜»å¡çš„æ—¶å€™ï¼ˆæ¯”å¦‚IOä»»åŠ¡ï¼‰ï¼Œåç¨‹è‡ªåŠ¨æŒ‚èµ·</li>
  <li>å½“é˜»å¡å®Œæˆçš„æ—¶å€™ï¼Œæ¢å¤åç¨‹ï¼Œç»§ç»­æ‰§è¡Œ</li>
</ul>

<p>æ˜¯ä¸æ˜¯å¾ˆåƒâ€œè¯·æ±‚å¼‚æ­¥ä»£ç†â€ï¼Œ workçº¿ç¨‹å°±åƒAgentæœåŠ¡ï¼Œåç¨‹å°±åƒæŠ›ç»™Agentçš„ä»»åŠ¡ï¼Œä¸åŒæ˜¯AgentæœåŠ¡ï¼ˆå‰ææ˜¯AgentæœåŠ¡æ˜¯ç”¨å¼‚æ­¥çº¿ç¨‹å®ç°çš„ï¼Œå¦‚æœç”¨åç¨‹å®ç°ï¼Œæ²¡å•¥åŒºåˆ«ï¼‰å°†ä¼šç”¨å¼‚æ­¥çº¿ç¨‹å»ç­‰å¾…IOå¹¶ä¸”è¿”å›ç»“æœï¼Œè€ŒQuasarçš„workçº¿ç¨‹æ˜¯è½®è¯¢è¿™äº›åç¨‹ä»»åŠ¡ï¼Œæœ‰IOå®Œæˆçš„ä¾¿è®©è¿™ä¸ªä»»åŠ¡è¿”å›ã€‚</p>

<p>åç¨‹ä¸æ˜¯çº¿ç¨‹ï¼Œæ›´ä¸æ˜¯è¿›ç¨‹ï¼Œæ‰€ä»¥åç¨‹å¹¶éå¼‚æ­¥ï¼Œä½†å´å¯ä»¥å……åˆ†åˆ©ç”¨CPUï¼Œä¸è¦å°†CPUçš„å®è´µèµ„æºæµªè´¹åœ¨ç­‰å¾…IOé˜»å¡ä¸Šï¼Œå› ä¸ºä¸æ˜¯çº¿ç¨‹ï¼Œæ‰€ä»¥ä¸ç”¨æ‹…å¿ƒçº¿ç¨‹çš„ç»´æŠ¤ã€‚æ›´ä¸ç”¨æ‹…å¿ƒå¤§é‡çº¿ç¨‹é˜»å¡å¯¼è‡´ç³»ç»Ÿå¯ç”¨èµ„æºä¸‹é™ã€‚</p>

<p>ä½¿ç”¨ä»£ç éšä¸‹ç« èŠ‚ç»™å‡ºã€‚</p>

<h2 id="heading-æ€§èƒ½æ¯”è¾ƒ">æ€§èƒ½æ¯”è¾ƒ</h2>

<p>æˆ‘ä»¬æ¨¡æ‹Ÿä¸€ä¸‹é‡åˆ°çš„æœåŠ¡åœºæ™¯ï¼Œåˆ†åˆ«ç”¨ Executor, ForkJoin, Quasar è¿›è¡Œé¡ºåºè¯·æ±‚ä»£ç çš„ä¿®æ”¹ï¼Œçœ‹ä¸‹æ•ˆç‡å¦‚ä½•</p>

<p>ä»£ç ç»“æ„å¦‚ä¸‹:</p>

<ul>
  <li>Main å……å½“è¯·æ±‚æ–¹ï¼Œå¯ä»¥å¹¶å‘å¯¹è°ƒç”¨MyServiceä¸­çš„æ–¹æ³•</li>
  <li>MyService å……å½“æˆ‘ä»¬è‡ªå·±çš„æœåŠ¡ï¼Œå“åº”Mainè¿›æ¥çš„è¯·æ±‚</li>
  <li>OtherService å……å½“åˆ«äººçš„æœåŠ¡ï¼ŒMyServiceä¾èµ–OtherServiceä¸­çš„æ–¹æ³•
    <ul>
      <li>OtherService ä»¥Sleepæ¥æ¨¡æ‹Ÿå“åº”å»¶è¿Ÿ</li>
    </ul>
  </li>
</ul>

<h3 id="heading-mainjava">Main.java</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Main</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="nc">ExecutorService</span> <span class="n">executorPool</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">int</span> <span class="n">poolSize</span> <span class="o">=</span> <span class="mi">300</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">int</span> <span class="n">requestSize</span> <span class="o">=</span> <span class="mi">300</span><span class="o">;</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">init</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">MyService</span><span class="o">.</span><span class="na">DEFAULT_DEPEND_COUNT</span> <span class="o">=</span> <span class="mi">5</span><span class="o">;</span> <span class="c1">//MyService è°ƒç”¨å…¶ä»–æœåŠ¡çš„æ¬¡æ•°</span>
        <span class="nc">MyService</span><span class="o">.</span><span class="na">disposeType</span> <span class="o">=</span> <span class="nc">MyService</span><span class="o">.</span><span class="na">DISPOSE_TYPE</span><span class="o">.</span><span class="na">COROUTINE</span><span class="o">;</span> <span class="c1">//MyService å¤„ç†ç±»å‹ï¼Œåˆ†ä¸ºåç¨‹ï¼Œå•çº¿ç¨‹ï¼Œå¤šçº¿ç¨‹(forkjoin, executor)</span>

        <span class="nc">OtherService</span><span class="o">.</span><span class="na">IS_RANDOM_DELAY</span> <span class="o">=</span> <span class="nc">Boolean</span><span class="o">.</span><span class="na">FALSE</span><span class="o">;</span> <span class="c1">// å»¶è¿Ÿæ˜¯å¦éšå³ç”Ÿæˆ</span>
        <span class="nc">OtherService</span><span class="o">.</span><span class="na">DEFAULT_DELAY</span> <span class="o">=</span> <span class="mi">500</span><span class="o">;</span> <span class="c1">//é»˜è®¤å»¶è¿Ÿæ—¶é—´ IS_RANDOM_DELAY==FALSE æ—¶å€™ç”Ÿæ•ˆ</span>
        <span class="nc">OtherService</span><span class="o">.</span><span class="na">DEFAULT_TIMEOUT</span> <span class="o">=</span> <span class="mi">10000</span><span class="o">;</span> <span class="c1">// é»˜è®¤è¶…æ—¶æ—¶é—´</span>
        <span class="nc">OtherService</span><span class="o">.</span><span class="na">DEFAULT_DELAY_UPPER</span> <span class="o">=</span> <span class="mi">10000</span><span class="o">;</span> <span class="c1">//éšæœºå»¶è¿Ÿçš„ä¸Šé™ IS_RANDOM_DELAY==TRUEçš„æ—¶å€™ç”Ÿæ•ˆ</span>

        <span class="n">poolSize</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span> <span class="c1">// è¯·æ±‚æ–¹çº¿ç¨‹æ± çš„å¤§å° è¿™ä¸ªæ— å…³ä¹MyServiceå’ŒOtherService</span>
        <span class="n">requestSize</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span> <span class="c1">//å¹¶å‘è¯·æ±‚æ¬¡æ•°</span>
        <span class="n">executorPool</span> <span class="o">=</span> <span class="nc">Executors</span><span class="o">.</span><span class="na">newFixedThreadPool</span><span class="o">(</span><span class="n">poolSize</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">init</span><span class="o">();</span>
        <span class="kt">int</span> <span class="n">successCount</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="kt">int</span> <span class="n">failCount</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="nc">Long</span> <span class="n">startTime</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">();</span>

        <span class="kd">final</span> <span class="nc">CountDownLatch</span> <span class="n">countDownLatch</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CountDownLatch</span><span class="o">(</span><span class="n">requestSize</span><span class="o">);</span>
        <span class="kd">final</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Future</span><span class="o">&lt;</span><span class="nc">Boolean</span><span class="o">&gt;&gt;</span> <span class="n">results</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">Future</span><span class="o">&lt;</span><span class="nc">Boolean</span><span class="o">&gt;&gt;();</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">requestSize</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">results</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">executorPool</span><span class="o">.</span><span class="na">submit</span><span class="o">(</span><span class="k">new</span> <span class="nc">Callable</span><span class="o">&lt;</span><span class="nc">Boolean</span><span class="o">&gt;()</span> <span class="o">{</span>
                <span class="kd">public</span> <span class="nc">Boolean</span> <span class="nf">call</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
                    <span class="kt">boolean</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">MyService</span><span class="o">().</span><span class="na">dispose</span><span class="o">();</span>
                    <span class="n">countDownLatch</span><span class="o">.</span><span class="na">countDown</span><span class="o">();</span>
                    <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
                <span class="o">}</span>
            <span class="o">}));</span>
        <span class="o">}</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">countDownLatch</span><span class="o">.</span><span class="na">await</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">Future</span><span class="o">&lt;</span><span class="nc">Boolean</span><span class="o">&gt;</span> <span class="n">future</span> <span class="o">:</span> <span class="n">results</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">future</span><span class="o">.</span><span class="na">get</span><span class="o">())</span> <span class="o">{</span>
                    <span class="n">successCount</span><span class="o">++;</span>
                <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                    <span class="n">failCount</span><span class="o">++;</span>
                <span class="o">}</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">failCount</span><span class="o">++;</span>
            <span class="o">}</span>
        <span class="o">}</span>

        <span class="nc">Long</span> <span class="n">endTime</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">();</span>

        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="nc">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"è¯·æ±‚å®Œæˆ, è€—æ—¶ %s ms, è¯·æ±‚æˆåŠŸ%sæ¬¡, å¤±è´¥%sæ¬¡"</span><span class="o">,</span> <span class="o">(</span><span class="n">endTime</span> <span class="o">-</span> <span class="n">startTime</span><span class="o">),</span> <span class="n">successCount</span><span class="o">,</span> <span class="n">failCount</span><span class="o">));</span>

        <span class="n">finish</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">finish</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">executorPool</span><span class="o">.</span><span class="na">shutdown</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="heading-myservicejava">MyService.java</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyService</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">int</span> <span class="no">DEFAULT_DEPEND_COUNT</span> <span class="o">=</span> <span class="mi">3</span><span class="o">;</span> <span class="c1">// é»˜è®¤ä¾èµ–å…¶ä»–æœåŠ¡è°ƒç”¨æ¬¡æ•°</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="no">DISPOSE_TYPE</span> <span class="n">disposeType</span> <span class="o">=</span> <span class="no">DISPOSE_TYPE</span><span class="o">.</span><span class="na">SEQUENCE</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">dependCount</span> <span class="o">=</span> <span class="no">DEFAULT_DEPEND_COUNT</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kd">enum</span> <span class="no">DISPOSE_TYPE</span> <span class="o">{</span><span class="no">MULTI_THREAD</span><span class="o">,</span> <span class="no">FORKJOIN</span><span class="o">,</span> <span class="no">COROUTINE</span><span class="o">,</span> <span class="no">SEQUENCE</span><span class="o">}</span>

    <span class="kd">public</span> <span class="nf">MyService</span><span class="o">()</span> <span class="o">{</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nf">MyService</span><span class="o">(</span><span class="kt">int</span> <span class="n">dependCount</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">dependCount</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">dependCount</span> <span class="o">=</span> <span class="no">DEFAULT_DEPEND_COUNT</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">dispose</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">switch</span> <span class="o">(</span><span class="n">disposeType</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">case</span> <span class="nl">MULTI_THREAD:</span>
                <span class="k">return</span> <span class="nf">disposeByExecutor</span><span class="o">();</span>
            <span class="k">case</span> <span class="nl">COROUTINE:</span>
                <span class="k">return</span> <span class="nf">disposeByCoroutine</span><span class="o">();</span>
            <span class="k">case</span> <span class="nl">FORKJOIN:</span>
                <span class="k">return</span> <span class="nf">disposeByForkJoin</span><span class="o">();</span>
            <span class="k">default</span><span class="o">:</span>
                <span class="k">return</span> <span class="nf">disposeBySequence</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="c1">//forkjoinå¤„ç†</span>
    <span class="kd">private</span> <span class="kt">boolean</span> <span class="nf">disposeByForkJoin</span><span class="o">()</span> <span class="o">{</span>
        <span class="kt">boolean</span> <span class="n">result</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>

        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Future</span><span class="o">&lt;</span><span class="nc">Boolean</span><span class="o">&gt;&gt;</span> <span class="n">futures</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">Future</span><span class="o">&lt;</span><span class="nc">Boolean</span><span class="o">&gt;&gt;(</span><span class="n">dependCount</span><span class="o">);</span>
        <span class="c1">//forkjoin çº¿ç¨‹æ±  å¸¦work-stealing</span>
        <span class="nc">ForkJoinPool</span> <span class="n">forkJoinPool</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ForkJoinPool</span><span class="o">();</span>
        <span class="kd">final</span> <span class="nc">CountDownLatch</span> <span class="n">countDownLatch</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CountDownLatch</span><span class="o">(</span><span class="n">dependCount</span><span class="o">);</span>

        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">dependCount</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">futures</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">forkJoinPool</span><span class="o">.</span><span class="na">submit</span><span class="o">(</span><span class="k">new</span> <span class="nc">Callable</span><span class="o">&lt;</span><span class="nc">Boolean</span><span class="o">&gt;()</span> <span class="o">{</span>
                <span class="kd">public</span> <span class="nc">Boolean</span> <span class="nf">call</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
                    <span class="nc">OtherService</span> <span class="n">otherService</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">OtherService</span><span class="o">();</span>
                    <span class="kt">boolean</span> <span class="n">result</span> <span class="o">=</span> <span class="n">otherService</span><span class="o">.</span><span class="na">dispose</span><span class="o">();</span>
                    <span class="n">countDownLatch</span><span class="o">.</span><span class="na">countDown</span><span class="o">();</span>
                    <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
                <span class="o">}</span>
            <span class="o">}));</span>
        <span class="o">}</span>

        <span class="k">try</span> <span class="o">{</span>
            <span class="n">countDownLatch</span><span class="o">.</span><span class="na">await</span><span class="o">();</span>
            <span class="n">result</span> <span class="o">=</span> <span class="nc">Boolean</span><span class="o">.</span><span class="na">TRUE</span><span class="o">;</span>
            <span class="k">for</span> <span class="o">(</span><span class="nc">Future</span><span class="o">&lt;</span><span class="nc">Boolean</span><span class="o">&gt;</span> <span class="n">future</span> <span class="o">:</span> <span class="n">futures</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">result</span> <span class="o">&amp;=</span> <span class="n">future</span><span class="o">.</span><span class="na">get</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">result</span> <span class="o">=</span> <span class="nc">Boolean</span><span class="o">.</span><span class="na">FALSE</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">// åç¨‹å¤„ç†</span>
    <span class="kd">private</span> <span class="kt">boolean</span> <span class="nf">disposeByCoroutine</span><span class="o">()</span> <span class="o">{</span>
        <span class="kt">boolean</span> <span class="n">result</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>

        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Fiber</span><span class="o">&lt;</span><span class="nc">Boolean</span><span class="o">&gt;&gt;</span> <span class="n">fibers</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">Fiber</span><span class="o">&lt;</span><span class="nc">Boolean</span><span class="o">&gt;&gt;();</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">dependCount</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">fibers</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nc">Fiber</span><span class="o">&lt;</span><span class="nc">Boolean</span><span class="o">&gt;(</span><span class="k">new</span> <span class="nc">SuspendableCallable</span><span class="o">&lt;</span><span class="nc">Boolean</span><span class="o">&gt;()</span> <span class="o">{</span>
                <span class="kd">public</span> <span class="nc">Boolean</span> <span class="nf">run</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">SuspendExecution</span><span class="o">,</span> <span class="nc">InterruptedException</span> <span class="o">{</span>
                    <span class="nc">OtherService</span> <span class="n">otherService</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">OtherService</span><span class="o">();</span>
                    <span class="k">return</span> <span class="n">otherService</span><span class="o">.</span><span class="na">dispose</span><span class="o">();</span>
                <span class="o">}</span>
            <span class="o">}).</span><span class="na">start</span><span class="o">());</span>
        <span class="o">}</span>

        <span class="n">result</span> <span class="o">=</span> <span class="nc">Boolean</span><span class="o">.</span><span class="na">TRUE</span><span class="o">;</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="k">for</span> <span class="o">(</span><span class="nc">Fiber</span><span class="o">&lt;</span><span class="nc">Boolean</span><span class="o">&gt;</span> <span class="n">fiber</span> <span class="o">:</span> <span class="n">fibers</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">result</span> <span class="o">&amp;=</span> <span class="n">fiber</span><span class="o">.</span><span class="na">get</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">result</span> <span class="o">=</span> <span class="nc">Boolean</span><span class="o">.</span><span class="na">FALSE</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="c1">// Executor å¤„ç†</span>
    <span class="kd">private</span> <span class="kt">boolean</span> <span class="nf">disposeByExecutor</span><span class="o">()</span> <span class="o">{</span>
        <span class="kt">boolean</span> <span class="n">result</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>

        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Future</span><span class="o">&lt;</span><span class="nc">Boolean</span><span class="o">&gt;&gt;</span> <span class="n">futures</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">Future</span><span class="o">&lt;</span><span class="nc">Boolean</span><span class="o">&gt;&gt;(</span><span class="n">dependCount</span><span class="o">);</span>
        <span class="c1">// æ™®é€šexecutorçº¿ç¨‹æ±  ä¸å¸¦work-stealing</span>
        <span class="nc">ExecutorService</span> <span class="n">executorService</span> <span class="o">=</span> <span class="nc">Executors</span><span class="o">.</span><span class="na">newFixedThreadPool</span><span class="o">(</span><span class="n">dependCount</span><span class="o">);</span>
        <span class="kd">final</span> <span class="nc">CountDownLatch</span> <span class="n">countDownLatch</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CountDownLatch</span><span class="o">(</span><span class="n">dependCount</span><span class="o">);</span>

        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">dependCount</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">futures</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">executorService</span><span class="o">.</span><span class="na">submit</span><span class="o">(</span><span class="k">new</span> <span class="nc">Callable</span><span class="o">&lt;</span><span class="nc">Boolean</span><span class="o">&gt;()</span> <span class="o">{</span>
                <span class="kd">public</span> <span class="nc">Boolean</span> <span class="nf">call</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
                    <span class="nc">OtherService</span> <span class="n">otherService</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">OtherService</span><span class="o">();</span>
                    <span class="kt">boolean</span> <span class="n">result</span> <span class="o">=</span> <span class="n">otherService</span><span class="o">.</span><span class="na">dispose</span><span class="o">();</span>
                    <span class="n">countDownLatch</span><span class="o">.</span><span class="na">countDown</span><span class="o">();</span>
                    <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
                <span class="o">}</span>
            <span class="o">}));</span>
        <span class="o">}</span>

        <span class="k">try</span> <span class="o">{</span>
            <span class="n">countDownLatch</span><span class="o">.</span><span class="na">await</span><span class="o">();</span>
            <span class="n">result</span> <span class="o">=</span> <span class="nc">Boolean</span><span class="o">.</span><span class="na">TRUE</span><span class="o">;</span>
            <span class="k">for</span> <span class="o">(</span><span class="nc">Future</span><span class="o">&lt;</span><span class="nc">Boolean</span><span class="o">&gt;</span> <span class="n">future</span> <span class="o">:</span> <span class="n">futures</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">result</span> <span class="o">&amp;=</span> <span class="n">future</span><span class="o">.</span><span class="na">get</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">result</span> <span class="o">=</span> <span class="nc">Boolean</span><span class="o">.</span><span class="na">FALSE</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="n">executorService</span><span class="o">.</span><span class="na">shutdown</span><span class="o">();</span>

        <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">// é¡ºåºå¤„ç†</span>
    <span class="kd">private</span> <span class="kt">boolean</span> <span class="nf">disposeBySequence</span><span class="o">()</span> <span class="o">{</span>
        <span class="kt">boolean</span> <span class="n">result</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>

        <span class="nc">OtherService</span> <span class="n">otherService</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">OtherService</span><span class="o">();</span>

        <span class="k">try</span> <span class="o">{</span>
            <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">dependCount</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
                <span class="c1">// è°ƒç”¨å…¶ä»–æœåŠ¡ï¼Œ300msçš„å»¶è¿Ÿ</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">otherService</span><span class="o">.</span><span class="na">dispose</span><span class="o">();</span>

                <span class="k">if</span> <span class="o">(!</span><span class="n">result</span><span class="o">)</span> <span class="o">{</span>
                    <span class="k">break</span><span class="o">;</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">result</span> <span class="o">=</span> <span class="nc">Boolean</span><span class="o">.</span><span class="na">FALSE</span><span class="o">;</span>
        <span class="o">}</span>


        <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="heading-otherservice">OtherService</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">OtherService</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">int</span> <span class="no">DEFAULT_TIMEOUT</span> <span class="o">=</span> <span class="mi">3000</span><span class="o">;</span> <span class="c1">//é»˜è®¤è¶…æ—¶æ—¶é—´ 3s</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">int</span> <span class="no">DEFAULT_DELAY</span> <span class="o">=</span> <span class="mi">300</span><span class="o">;</span> <span class="c1">//é»˜è®¤å»¶è¿Ÿ300ms</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">int</span> <span class="no">DEFAULT_DELAY_UPPER</span> <span class="o">=</span> <span class="mi">5000</span><span class="o">;</span> <span class="c1">//é»˜è®¤å»¶è¿Ÿä¸Šé™ 10s</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">boolean</span> <span class="no">IS_RANDOM_DELAY</span> <span class="o">=</span> <span class="nc">Boolean</span><span class="o">.</span><span class="na">FALSE</span><span class="o">;</span> <span class="c1">//å»¶è¿Ÿéšæœº</span>

    <span class="c1">// è¿™ä¸ªæ³¨è§£æ˜¯Quasaræä¾›çš„ï¼Œè¡¨æ˜è¿™ä¸ªæ–¹æ³•å‘ç”Ÿé˜»å¡çš„æ—¶å€™æ˜¯å¯ä»¥è¢«æŒ‚èµ·çš„</span>
    <span class="nd">@Suspendable</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">dispose</span><span class="o">()</span> <span class="o">{</span>
        <span class="kt">boolean</span> <span class="n">result</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>

        <span class="kt">int</span> <span class="n">delay</span> <span class="o">=</span> <span class="no">DEFAULT_DELAY</span><span class="o">;</span>

        <span class="k">if</span> <span class="o">(</span><span class="no">IS_RANDOM_DELAY</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">Random</span> <span class="n">random</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Random</span><span class="o">();</span>
            <span class="n">delay</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="no">DEFAULT_DELAY_UPPER</span><span class="o">);</span>

        <span class="o">}</span>

        <span class="k">if</span> <span class="o">(</span><span class="n">delay</span> <span class="o">&gt;</span> <span class="no">DEFAULT_TIMEOUT</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">result</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="n">result</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="k">try</span> <span class="o">{</span>
            <span class="nc">Strand</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="n">delay</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="n">result</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>

<p>ä¸ºäº†æµ‹è¯•æ–¹ä¾¿ï¼Œåœ¨Mainä¸­ï¼Œæˆ‘ä»¬åŠ å…¥äº†ä¸€äº›å¯é…ç½®çš„ä¸œè¥¿ï¼Œéƒ½åœ¨init()æ–¹æ³•ä¸­</p>

<h3 id="heading-æµ‹è¯•æ•°æ®å’Œç»“æœ">æµ‹è¯•æ•°æ®å’Œç»“æœ</h3>

<table>
  <thead>
    <tr>
      <th style="text-align: left">åºå·</th>
      <th style="text-align: left">è¯·æ±‚æ¬¡æ•°</th>
      <th style="text-align: left">æ¯æ¬¡è¯·æ±‚MyServiceè°ƒç”¨OtherServiceæ¬¡æ•°</th>
      <th style="text-align: left">å¹³å‡å»¶è¿Ÿ</th>
      <th style="text-align: left">è¶…æ—¶æ—¶é—´</th>
      <th style="text-align: left">è°ƒç”¨æ–¹å¼</th>
      <th style="text-align: left">å“åº”æ—¶é—´ms</th>
      <th>å¤‡æ³¨</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">1-0</td>
      <td style="text-align: left">1</td>
      <td style="text-align: left">5</td>
      <td style="text-align: left">500ms</td>
      <td style="text-align: left">3000ms</td>
      <td style="text-align: left">SEQUENCE</td>
      <td style="text-align: left">2730</td>
      <td>Â </td>
    </tr>
    <tr>
      <td style="text-align: left">1-1</td>
      <td style="text-align: left">1</td>
      <td style="text-align: left">5</td>
      <td style="text-align: left">500ms</td>
      <td style="text-align: left">3000ms</td>
      <td style="text-align: left">MULTI_THREAD</td>
      <td style="text-align: left">677</td>
      <td>Executorçº¿ç¨‹æ± 10</td>
    </tr>
    <tr>
      <td style="text-align: left">1-2</td>
      <td style="text-align: left">1</td>
      <td style="text-align: left">5</td>
      <td style="text-align: left">500ms</td>
      <td style="text-align: left">3000ms</td>
      <td style="text-align: left">FORKJOIN</td>
      <td style="text-align: left">1160</td>
      <td>Â </td>
    </tr>
    <tr>
      <td style="text-align: left">1-3</td>
      <td style="text-align: left">1</td>
      <td style="text-align: left">5</td>
      <td style="text-align: left">500ms</td>
      <td style="text-align: left">3000ms</td>
      <td style="text-align: left">COROUTINE</td>
      <td style="text-align: left">1146</td>
      <td>Â </td>
    </tr>
  </tbody>
</table>

<table>
  <thead>
    <tr>
      <th style="text-align: left">åºå·</th>
      <th style="text-align: left">è¯·æ±‚æ¬¡æ•°</th>
      <th style="text-align: left">æ¯æ¬¡è¯·æ±‚MyServiceè°ƒç”¨OtherServiceæ¬¡æ•°</th>
      <th style="text-align: left">å¹³å‡å»¶è¿Ÿ</th>
      <th style="text-align: left">è¶…æ—¶æ—¶é—´</th>
      <th style="text-align: left">è°ƒç”¨æ–¹å¼</th>
      <th style="text-align: left">å“åº”æ—¶é—´ms</th>
      <th>å¤‡æ³¨</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">2-0</td>
      <td style="text-align: left">1</td>
      <td style="text-align: left">1000</td>
      <td style="text-align: left">500ms</td>
      <td style="text-align: left">3000ms</td>
      <td style="text-align: left">SEQUENCE</td>
      <td style="text-align: left">è¿™ä¸ªæ—¶é—´é•¿çš„ä¸æƒ³ç­‰äº†</td>
      <td>Â </td>
    </tr>
    <tr>
      <td style="text-align: left">2-1</td>
      <td style="text-align: left">1</td>
      <td style="text-align: left">1000</td>
      <td style="text-align: left">500ms</td>
      <td style="text-align: left">3000ms</td>
      <td style="text-align: left">MULTI_THREAD</td>
      <td style="text-align: left">5235</td>
      <td>Executorçº¿ç¨‹æ± 10</td>
    </tr>
    <tr>
      <td style="text-align: left">2-2</td>
      <td style="text-align: left">1</td>
      <td style="text-align: left">1000</td>
      <td style="text-align: left">500ms</td>
      <td style="text-align: left">3000ms</td>
      <td style="text-align: left">FORKJOIN</td>
      <td style="text-align: left">126118</td>
      <td>Â </td>
    </tr>
    <tr>
      <td style="text-align: left">2-3</td>
      <td style="text-align: left">1</td>
      <td style="text-align: left">1000</td>
      <td style="text-align: left">500ms</td>
      <td style="text-align: left">3000ms</td>
      <td style="text-align: left">COROUTINE</td>
      <td style="text-align: left">1146</td>
      <td>Â </td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p>ForkJoin å“åº”æ—¶é—´é•¿çš„æœ‰ç‚¹æƒŠäººï¼Œæ‰“å°jstackå‘ç°ä»…ä»…æœ‰4ä¸ªworkçº¿ç¨‹å¤„ç†ä»»åŠ¡ <a href="http://7xoguv.com1.z0.glb.clouddn.com/fj-1-1000">jstack</a></p>
</blockquote>

<table>
  <thead>
    <tr>
      <th style="text-align: left">åºå·</th>
      <th style="text-align: left">è¯·æ±‚æ¬¡æ•°</th>
      <th style="text-align: left">æ¯æ¬¡è¯·æ±‚MyServiceè°ƒç”¨OtherServiceæ¬¡æ•°</th>
      <th style="text-align: left">å¹³å‡å»¶è¿Ÿ</th>
      <th style="text-align: left">è¶…æ—¶æ—¶é—´</th>
      <th style="text-align: left">è°ƒç”¨æ–¹å¼</th>
      <th style="text-align: left">å“åº”æ—¶é—´ms</th>
      <th>å¤‡æ³¨</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">3-0</td>
      <td style="text-align: left">1000</td>
      <td style="text-align: left">5</td>
      <td style="text-align: left">500ms</td>
      <td style="text-align: left">3000ms</td>
      <td style="text-align: left">SEQUENCE</td>
      <td style="text-align: left">3027</td>
      <td>Â </td>
    </tr>
    <tr>
      <td style="text-align: left">3-1</td>
      <td style="text-align: left">1000</td>
      <td style="text-align: left">5</td>
      <td style="text-align: left">500ms</td>
      <td style="text-align: left">3000ms</td>
      <td style="text-align: left">MULTI_THREAD</td>
      <td style="text-align: left">OOM</td>
      <td>Executorçº¿ç¨‹æ± 10</td>
    </tr>
    <tr>
      <td style="text-align: left">3-2</td>
      <td style="text-align: left">1000</td>
      <td style="text-align: left">5</td>
      <td style="text-align: left">500ms</td>
      <td style="text-align: left">3000ms</td>
      <td style="text-align: left">FORKJOIN</td>
      <td style="text-align: left">OOM</td>
      <td>Â </td>
    </tr>
    <tr>
      <td style="text-align: left">3-3</td>
      <td style="text-align: left">1000</td>
      <td style="text-align: left">5</td>
      <td style="text-align: left">500ms</td>
      <td style="text-align: left">3000ms</td>
      <td style="text-align: left">COROUTINE</td>
      <td style="text-align: left">1389</td>
      <td>Â </td>
    </tr>
  </tbody>
</table>

<table>
  <thead>
    <tr>
      <th style="text-align: left">åºå·</th>
      <th style="text-align: left">è¯·æ±‚æ¬¡æ•°</th>
      <th style="text-align: left">æ¯æ¬¡è¯·æ±‚MyServiceè°ƒç”¨OtherServiceæ¬¡æ•°</th>
      <th style="text-align: left">å¹³å‡å»¶è¿Ÿ</th>
      <th style="text-align: left">è¶…æ—¶æ—¶é—´</th>
      <th style="text-align: left">è°ƒç”¨æ–¹å¼</th>
      <th style="text-align: left">å“åº”æ—¶é—´ms</th>
      <th>å¤‡æ³¨</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">4-0</td>
      <td style="text-align: left">10000</td>
      <td style="text-align: left">3</td>
      <td style="text-align: left">500ms</td>
      <td style="text-align: left">3000ms</td>
      <td style="text-align: left">SEQUENCE</td>
      <td style="text-align: left">21186</td>
      <td>Â </td>
    </tr>
    <tr>
      <td style="text-align: left">4-1</td>
      <td style="text-align: left">10000</td>
      <td style="text-align: left">3</td>
      <td style="text-align: left">500ms</td>
      <td style="text-align: left">3000ms</td>
      <td style="text-align: left">MULTI_THREAD</td>
      <td style="text-align: left">OOM</td>
      <td>Executorçº¿ç¨‹æ± 10</td>
    </tr>
    <tr>
      <td style="text-align: left">4-2</td>
      <td style="text-align: left">10000</td>
      <td style="text-align: left">3</td>
      <td style="text-align: left">500ms</td>
      <td style="text-align: left">3000ms</td>
      <td style="text-align: left">FORKJOIN</td>
      <td style="text-align: left">OOM</td>
      <td>Â </td>
    </tr>
    <tr>
      <td style="text-align: left">4-3</td>
      <td style="text-align: left">10000</td>
      <td style="text-align: left">3</td>
      <td style="text-align: left">500ms</td>
      <td style="text-align: left">3000ms</td>
      <td style="text-align: left">COROUTINE</td>
      <td style="text-align: left">5906</td>
      <td>Â </td>
    </tr>
  </tbody>
</table>

<p><strong>æ˜¯ä¸æ˜¯æ„Ÿè§‰Quasarçš„è¡¨ç°æ£’æ£’çš„ï½</strong></p>

<h3 id="heading-jstack">jstack</h3>

<p>ä¸‹é¢æˆ‘ä»¬æŠŠå»¶è¿Ÿè°ƒé•¿ç‚¹ï¼š300000ï¼Œè¶…æ—¶æ—¶é—´ï¼š300000ï¼Œè¯·æ±‚æ¬¡æ•°5ï¼Œä¾èµ–è°ƒç”¨æ¬¡æ•°5æ¬¡ï¼Œ çœ‹ä¸‹çº¿ç¨‹æ ˆ(è°ƒé•¿ç‚¹æ˜¯ä¸ºäº†æ‰“å †æ ˆå¯ä»¥ååº”è¿‡æ¥) ç‚¹å‡»ä¸‹é¢çš„é“¾æ¥å¯ä»¥ä¸‹è½½å †æ ˆæ–‡ä»¶:</p>

<p>ğŸ‘‰ <a href="http://7xoguv.com1.z0.glb.clouddn.com/sq-5-5">SEQUENCE</a></p>

<p>ğŸ‘‰ <a href="http://7xoguv.com1.z0.glb.clouddn.com/mt-5-5">MULTI_THREAD</a></p>

<p>ğŸ‘‰ <a href="http://7xoguv.com1.z0.glb.clouddn.com/fj-5-5">FORKJOIN</a></p>

<p>ğŸ‘‰ <a href="http://7xoguv.com1.z0.glb.clouddn.com/co-5-5">COROUTINE</a></p>

<p>ä¸Šé¢å †æ ˆä¿¡æ¯å¯ä»¥è§£é‡Šä¸Šé¢å‡ ä¸ªé—®é¢˜ï¼š</p>

<ul>
  <li>3-2 ï¼ 3-3 çš„ <code class="language-plaintext highlighter-rouge">OOM</code>:</li>
</ul>

<p>1000 * 5 æ•°é‡çº§çš„çº¿ç¨‹è¢«åˆ›å»ºï¼Œä¼°è®¡å¾ˆå®¹æ˜“è¢«OOMå§ï½</p>

<ul>
  <li>2-2 å“åº”æ—¶é—´ <code class="language-plaintext highlighter-rouge">126118ms</code></li>
</ul>

<p>ä¸Šé¢çš„æ•°é‡çº§æ‰“åˆ°1000ï¼Œä»jstackæ¥çœ‹ ForkJoin ä»…ä»…å¼€äº†3ä¸ªworkçº¿ç¨‹ï¼Œå“åº”æ—¶é—´è‚¯å®šä¼šå¾ˆé•¿</p>

<ul>
  <li>Quasar åº•å±‚çš„workçº¿ç¨‹æ˜¯ç”¨fork-join-poolå®ç°çš„</li>
</ul>

<h2 id="heading-è¿˜å¯ä»¥æ›´å¥½">è¿˜å¯ä»¥æ›´å¥½</h2>

<p>æ¯•ç«ŸSleepæ¨¡æ‹ŸIOå»¶è¿Ÿä¸å¤ªåˆé€‚ï¼Œæœ¬æ¥æ˜¯å‡†å¤‡äº†1000Wçš„DBæ•°æ®åš <code class="language-plaintext highlighter-rouge">limit offset</code> æ¥æ¨¡æ‹Ÿ DBé•¿æ—¶é—´IOçš„ï¼Œä½†æ˜¯è€ƒè™‘åˆ°å¤šçº¿ç¨‹è¯»DBæœ‰å›å¸¦æ¥å¦å¤–çš„é—®é¢˜ï¼ŒåŠ ä¸Šå®åœ¨æ˜¯å¤ªæ™šäº†ï¼ˆå·²ç»å‡Œæ™¨ä¸¤ç‚¹äº†ï¼Œç¬¬äºŒå¤©è¿˜è¦ä¸Šç­â€¦â€¦ï¼‰ï¼Œæ‰€ä»¥æƒ³äº†ä¸¤ä¸ªåŠæ³•ï¼Œ1. æ‰¾æ—¶é—´æä¸€æDBå»¶è¿Ÿã€‚ 2. æ‹¿å…¬å¸çš„é¡¹ç›®è¯•ä¸€ä¸‹ï¼Œçœ‹å‹æµ‹ç»“æœä¾¿çŸ¥é“æ•ˆæœäº†ã€‚</p>

<p>å¦‚æœä¸Šé¢Demoå†™çš„å“ªé‡Œæœ‰é—®é¢˜ï¼Œæ¬¢è¿æŒ‡å‡ºæ”¹è¿›ã€‚</p>

<h2 id="heading-å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™</h2>

<ul>
  <li><a href="http://www.infoq.com/cn/articles/fork-join-introduction">èŠèŠå¹¶å‘</a></li>
  <li><a href="http://colobu.com/2016/07/14/Java-Fiber-Quasar/">Javaä¸­çš„çº¤ç¨‹åº“</a></li>
  <li><a href="http://colobu.com/2016/08/01/talk-about-quasar-again/">ç»§ç»­äº†è§£Javaçš„çº¤ç¨‹åº“</a></li>
  <li><a href="https://juejin.im/entry/58c0cb63a22b9d0058914057">è¶…è¯¦ç»† java ä¸­çš„ ClassLoader è¯¦è§£</a></li>
  <li><a href="http://docs.paralleluniverse.co/quasar/#specifying-the-java-agent-with-gradle">Quasarå®˜ç½‘æ‰‹å†Œ</a></li>
  <li><a href="https://www.oschina.net/question/2680454_2180396">æ¬¡æ—¶ä»£javaæ—¶ä»£</a></li>
  <li><a href="https://www.ibm.com/developerworks/cn/java/j-rtj2/index.html">æ¯”è¾ƒç¼–è¯‘æŠ€æœ¯</a></li>
  <li><a href="http://ifeve.com/java7-fork-join-and-closure/">java7é‡Œçš„fork-join</a></li>
  <li><a href="https://segmentfault.com/a/1190000006079389">Coroutine in Java - Quasar Fiberå®ç°</a></li>
  <li><a href="http://www.importnew.com/14506.html">Javaå¹¶å‘çš„å››ç§é£å‘³</a></li>
</ul>

<h2 id="heading-æ„Ÿè°¢">æ„Ÿè°¢</h2>

<p>æ„Ÿè°¢å…¬å¸åŒäº‹æä¾›çš„å„ç§å¸®åŠ©å’Œå¼•å¯¼ï¼Œåœ¨äº‰è®ºä¸­æˆé•¿ã€‚</p>

<h2 id="heading-github">GitHub</h2>

<p>è¿™é‡Œçš„ä»£ç æ˜¯ä»<a href="https://github.com/puniverse/quasar-gradle-template">å®˜æ–¹æ¨èä»£ç </a> Cloneä¸‹æ¥å¹¶ä¸”åšäº†äº›<a href="https://github.com/SUT-GC/quasar-example">ä¿®æ”¹ä¹‹åçš„ä»£ç </a></p>

:ET